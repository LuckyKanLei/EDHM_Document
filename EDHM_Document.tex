% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Editable Distributed Hydrological Model},
  pdfauthor={Kan Lei},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Editable Distributed Hydrological Model}
\author{Kan Lei}
\date{2021-04-17}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\begin{verbatim}
## [[1]]
## [[1]][[1]]
## NULL
## 
## [[1]][[2]]
## NULL
## 
## [[1]][[3]]
## NULL
## 
## 
## [[2]]
## [[2]][[1]]
## NULL
## 
## [[2]][[2]]
## NULL
## 
## 
## [[3]]
## [[3]][[1]]
## NULL
## 
## [[3]][[2]]
## NULL
## 
## 
## [[4]]
## [[4]][[1]]
## NULL
## 
## 
## [[5]]
## [[5]][[1]]
## NULL
## 
## 
## [[6]]
## [[6]][[1]]
## NULL
## 
## 
## [[7]]
## [[7]][[1]]
## NULL
## 
## [[7]][[2]]
## NULL
## 
## 
## [[8]]
## [[8]][[1]]
## NULL
## 
## [[8]][[2]]
## NULL
## 
## [[8]][[3]]
## NULL
## 
## [[8]][[4]]
## NULL
## 
## [[8]][[5]]
## NULL
## 
## 
## [[9]]
## [[9]][[1]]
## NULL
## 
## 
## [[10]]
## [[10]][[1]]
## NULL
## 
## [[10]][[2]]
## NULL
\end{verbatim}

\hypertarget{the-document-and-the-edhm-package}{%
\chapter*{The Document and the EDHM Package}\label{the-document-and-the-edhm-package}}
\addcontentsline{toc}{chapter}{The Document and the EDHM Package}

\hypertarget{the-document}{%
\section*{The Document}\label{the-document}}
\addcontentsline{toc}{section}{The Document}

This document is the use guide for EDHM and some other concept about the hydrological models (\textbf{HM}) building. In Chapter \ref{base} explain the basic concept of hydrological cycle and the important concept and idea of EDHM. In chapter \ref{develop} show the workflow of using a hydrological model with EDHM and the way to explain a new model. Chapter \ref{module} and \ref{model} show the basic information, e.g.~input data, parameters and output data of every module or model.

\hypertarget{edhm}{%
\section*{EDHM}\label{edhm}}
\addcontentsline{toc}{section}{EDHM}

\includegraphics{fig/EDHM_logo3.png}

EDHM is a R package for hydrological models in order to simplify the models building, specially the distributed hydrological model. In the package contain many complete \textbf{MODEL} that can used directly, and many \textbf{MODULE} that can a new MODEL to building. All of the MODELs and MODULEs are build with matrix-arithmetic, that can good deal with the distributed situation. In the package there are many tools to calibrate the parameters or build a new MODEL or a new MODULE. The Package is only in GitHub published, for the first time use, please install the package \href{https://github.com/LuckyKanLei/EDHM}{EDHM} and \href{https://github.com/LuckyKanLei/HMtools}{HMtools} use the following code:

\begin{verbatim}
install.packages("devtools")
devtools::install_github("LuckyKanLei/HMtools")
devtools::install_github("LuckyKanLei/EDHM")
\end{verbatim}

The summary of the Processes and Modules show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l}
\hline
PROCESS & MODULE\\
\hline
ReferenceET & [ReferenceET.Hargreaves](\#ReferenceET.Hargreaves) | [ReferenceET.Linacre](\#ReferenceET.Linacre) | [ReferenceET.PenMon](\#ReferenceET.PenMon)\\
\cline{1-2}
ActualET & [ActualET.Gr4j](\#ActualET.Gr4j) | [ActualET.Vic](\#ActualET.Vic)\\
\cline{1-2}
SNOW & [SNOW.17](\#SNOW.17) | [SNOW.Ddf](\#SNOW.Ddf)\\
\cline{1-2}
BASEFLOW & [BASEFLOW.ARNO](\#BASEFLOW.ARNO)\\
\cline{1-2}
INTERCEPTION & [INTERCEPTION.Gash](\#INTERCEPTION.Gash)\\
\cline{1-2}
InfiltratRat & [InfiltratRat.GreenAmpt](\#InfiltratRat.GreenAmpt)\\
\cline{1-2}
Infiltration & [Infiltration.OIER](\#Infiltration.OIER) | [Infiltration.SER](\#Infiltration.SER)\\
\cline{1-2}
RUNOFF & [RUNOFF.Gr4j](\#RUNOFF.Gr4j) | [RUNOFF.OIER](\#RUNOFF.OIER) | [RUNOFF.SER](\#RUNOFF.SER) | [RUNOFF.Vic](\#RUNOFF.Vic) | [RUNOFF.VM](\#RUNOFF.VM)\\
\cline{1-2}
GROUNDWATER & [GROUNDWATER.Vic](\#GROUNDWATER.Vic)\\
\cline{1-2}
ROUTE & [ROUTE.G2RES](\#ROUTE.G2RES) | [ROUTE.Gr4j](\#ROUTE.Gr4j)\\
\hline
\end{tabular}
\end{table}

\hypertarget{base}{%
\chapter{Basic Concept}\label{base}}

Before using of the EDHM it's very important to know the basic concept and primary idea about EDHM.

In EDHM the two mostly characters are \textbf{modularization} and \textbf{vectorization-arithmetic}, \textbf{modularization} focus on the coupling of the different \emph{modules} of the hydrological \emph{processes}, benefit by the modularization it's very convenience to change the method of process, what means the \textbf{editable} model; \textbf{vectorization-arithmetic} is very useful for the distributed hydrological model, it can greatly short the calculate time, especially when there are many grids (calculate units).

The water cycle of the Earth system and its variability at global, regional and local scales are influenced by a range of processes and mutual interactions, feedback mechanisms and as well as affected by anthropogenic processes.\citep{Rast.2014}

In EDHM a \textbf{PROCESS} is the mapping from those hydrological processes in a digital from, at the same time it's also the group (set) name of the some \textbf{MODULE}s those haven the same functions and same aims, and
a \textbf{MODULE} is the definite method of a \textbf{PROCESS}, for example \protect\hyperlink{SNOW}{SNOW} is PROCESS mapping the process that snow melting, accumulate and the state variety, \protect\hyperlink{SNOW.17}{SNOW.17} is then the true function that you can call in R, with the method by Andrson\citep{Anderson.1973} forward.

Besides the PROCESS based on the hydrological processes, but sometimes a little different, due to the calculate factors in the lang time, some like \emph{evapotranspiration} is a typical hydrological process, but in EDHM es is diveded into \protect\hyperlink{ReferenceET}{ReferenceET} (reference evapotranspiration) and \protect\hyperlink{ActualET}{ActualET} (actual evapotranspiration) two parts, because the most conceptual models calculate evapotranspiration in the two steps.

In the following section will show the meaning of hydrological processes and the mapped PROCESS.

\textbf{MODEL} is a coupled complete process with some subprocesses (also possible only one process), in EDHM is a true function to simulation the designed model with definite methods. It's also a set of \textbf{MODULE}s, those realize different process and correctly by the physical process.

The \textbf{VARIABLE} is the data those describe the state or character of the environment and the volume or character of water in different process. And in order to quickly find the VARIABLE and avoid the duplicate name of VARIABLE, the \textbf{GROUP} is like the folder of VARIABLE designed, for example in GROUP \emph{Evatrans} (evapotranspiration) include the VARIABLEs \emph{RET} (reference evapotranspiration), \emph{AET} (actual evapotranspiration) and so on.

It can be summarized as:

\textbf{MODULE} = \textbf{PROCESS} \(\times\) \textbf{Method}

\textbf{MODEL} = \(\sum\) \textbf{MODULE}\(_i\)

\textbf{VARIABLE} are putted in the \textbf{GROUP}

\hypertarget{basic-concept-of-hydrological-cycle}{%
\section{Basic Concept of Hydrological Cycle}\label{basic-concept-of-hydrological-cycle}}

\includegraphics{fig/EDHM_cycle.png}

The hydrological cycle is composed of different components, which include evaporation from water surfaces and bare soil, evapotranspiration from vegetated land, transport of water vapour in the atmosphere, cloud droplet formation and cloud dynamics, the mechanisms leading to liquid and solid precipitation, the movement of water and change in soil moisture in the unsaturated soil, including root dynamics, surface and river run-off, and groundwater flow.\citep{Rast.2014}

Also from \citep{LANGBEIN.1960}: A convenient term to denote the circulation of water from the sea, through the atmos- phere, to the land; and thence, with many delays, back to the sea by overland and subterranean routes, and in part by way of the atmosphere; also the many short circuits of the water that is re- turned to the atmosphere without reaching the see.

The whole cycle will spilt by the vertical layer in six layers which are \protect\hyperlink{Atmosphe1}{Atmosphe}, \protect\hyperlink{Snow1}{Snow}, \protect\hyperlink{Canopy1}{Canopy}, \protect\hyperlink{Surface}{Surface}, \protect\hyperlink{Subsurface1}{Subsurface} and \protect\hyperlink{Ground1}{Ground}. There indeed are not the complete hydrological cycle components, limited by the first stage, in the first stage will focus on the conceptual models.

\hypertarget{Atmosphe1}{%
\subsection{Atmosphere (Atmos)}\label{Atmosphe1}}

In the Atmosphere major occur the process precipitation and part of the evapotranspiration, the concept of the evapotranspiration will show in section \ref{Canopy1} in Canopy group.

\textbf{\emph{Precipitation:}} As used in hydrology, precipitation is the discharge of water, in liquid or solid state, out of the atmosphere, generally upon a land or water surface. It is the common process by which atmospheric water becomes surface or subsurface water * * *. The term ``precipitation'' is also commonly used to designate the quantity of water that is precipitated. (Meinzer, 1923, p.~15.) Precipitation includes rainfall, snow, hail, and sleet, and is therefore a more general terr than rainfall.

\textbf{\emph{Effective precipitation:}} 1. That part of the precipitation that produces runoff. 2. A weighted average of current and antecedent precipitation that is ``effective'' in correlating with runoff.\citep{LANGBEIN.1960}

The two most important forms of precipitation are rainfall and snowfall, the other form will not considered in general situation or simulation.

\textbf{\emph{Rainfall:}} The quantity of water that falls as rain only. Not synonymous with precipitation.

\textbf{\emph{Snowfall:}} A form of precipitation composed of ice crystals.

In this layer PROCESS \protect\hyperlink{SNOW}{PRECDicid} and GROUP \textbf{\emph{Prec}} show in the following Table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
Precipitation & mm & Precipitation, summe of rain and snow\\
\cline{1-3}
SnowFall & mm & Snow\\
\cline{1-3}
RainFall & mm & Rain\\
\hline
\end{tabular}
\end{table}

And the typical meteorological data set \textbf{\emph{MetData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
TAir & Cel & Average Air temperature in Timestep\\
\cline{1-3}
TMax & Cel & Maximal Air temperature in one day\\
\cline{1-3}
TMin & Cel & Minimul Air temperature in one day\\
\cline{1-3}
Actual\_vapor\_press & mPa & Actual vapor press\\
\cline{1-3}
RelativeHumidity & \% & Relative Humidity, not greater than 100\\
\cline{1-3}
WindSpeed & m/s & Average Wind Speed\\
\cline{1-3}
WindH & m & The hight to mess the WindSpeed\\
\cline{1-3}
SunHour & h & Sunshine duration in one day\\
\hline
\end{tabular}
\end{table}

\hypertarget{Snow1}{%
\subsection{Snow}\label{Snow1}}

\textbf{\emph{waterequivalent of snow:}} Amount of water that would be obtained if the snow should be completely melted. Water content may be merely the amount of liquid water in the snow at the time of observation. (Wilson, 1942a, p.~153-154.)

In this layer PROCESS \protect\hyperlink{SNOW}{SNOW} and GROUP \textbf{\emph{Snow}} show in the following Table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
Ice\_Volume & mm & Soild Ice Volume, not depth\\
\cline{1-3}
Liquid\_Volume & mm & Liquid Volume\\
\cline{1-3}
SN17\_ATI & -- & --\\
\cline{1-3}
SN17\_HD & mm & --\\
\cline{1-3}
Volume & mm & Summe Volume of Ice and liquid water, not depth\\
\hline
\end{tabular}
\end{table}

\hypertarget{Canopy1}{%
\subsection{Canopy}\label{Canopy1}}

\textbf{\emph{Condensation:}} The process by which water changes from the vapor state into the liquid or solid state. It is the reverse of evaporation.\citep{LANGBEIN.1960}

\textbf{\emph{Evaporation:}}The process by which water is changed from the liquid or the solid state into the vapor state. In hydrology, evaporation is vaporization that takes place at a temperature below the boiling point.\citep{LANGBEIN.1960}

\textbf{\emph{Transpritation:}} The quantity of water absorbed and transpired and used directly in the bulling of plant tissue, in a specified time. It does not include soil evaporation. (After Blaney, I951a, p.~4.) The process by which water vapor escapes from the living plant, principally the leaves, and enters the atmosphere. As considered practically, transpiration also includes \emph{guttation}. (Lee, 1949, p.~260.)

\textbf{\emph{Evapotranspiration:}} Water withdrawn from a land area by evaporation from water surfaces and moist, soil and plant transpiration.\citep{LANGBEIN.1960}

\textbf{\emph{Relative evaporation:}} The ratio of the rate of evaporation from a land or water surface in contact with the atmosphere, to the evaporativity under existing atmospheric conditions. It is the ratio of actual to potential rate of evaporation, generally stated as a percentage. (Derived from Meinzer, 1923, p.~14.) The opportunity for a given rate of evaporation to continue is determined by the available moisture supply. (Meyer, 1928, p.~244.)

\textbf{\emph{Potential evaporation:}} Water loss that will occur if at no time there is a deficiency of water in the soil for use of vegetation. (Thornthwaite, 1944, p.~687.)

\textbf{\emph{Interception:}} The process and the amount of rain or snow stored on leaves and branches and eventually evaporated back to the air. Interception equals the precipitation on the vegetation minus stem flow and throughfall (after Hoover, 1953, p.~1.)

In this layer PROCESS \protect\hyperlink{ReferenceET}{ReferenceET}, \protect\hyperlink{ActualET}{ActualET}, \protect\hyperlink{INTERCEPTION}{INTERCEPTION} and GROUP \textbf{\emph{Evatrans}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
RET & mm & Reference evapotranspiration\\
\cline{1-3}
EvaporationCanopy & mm & Evaporation from Canopy\\
\cline{1-3}
AET & mm & Actual evapotranspiration\\
\cline{1-3}
Transpiration & mm & Transpiration (water from Root layer of vegetation)\\
\cline{1-3}
EvaporationLand & mm & Evaporation from Landsurface (sometimes cotain the Evaporation from Watersurface like Lake)\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Intercept}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
Interception & mm & Interception in Canopy\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Canopy}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
StorageCapacity & mm & Canopy Storage Capacity for Intercept and Evaporation from Canopy\\
\hline
\end{tabular}
\end{table}

And \textbf{\emph{Aerodyna}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
AerodynaResist & s/m & Aerodyna Resist\\
\cline{1-3}
ArchitecturalResist & s/m & Architectural Resist\\
\cline{1-3}
StomatalResist & s/m & Stomatal Resist\\
\hline
\end{tabular}
\end{table}

\hypertarget{Surface1}{%
\subsection{Surface (Runoff, Route)}\label{Surface1}}

\textbf{\emph{Runoff:}} That part of the precipitation that appears in surface streams. It is the same as streamflow unaffected by artificial diversions, storage, or other works of man in or on the stream channels. Runoff may be classified as follows: Classification as to speed of appearance after rain- fall or snow melting: Direct runoff Base runoff Classification as to source: Surface runoff Storm seepage Groundwater runoff.

\textbf{\emph{Surface runoff:}} That part of the runoff which travels over the soil surface to the nearest stream channel. It is also defined as that part of the runoff of a drainage basin that has not passed beneath the surface since precipitation. The term is misused when applied in the sense of direct runoff. See also, Runoff, Overland flow, Direct runoff, Groundwater runoff, and Surface water.

\textbf{\emph{Direct runoff:}} The runoff entering stream channels promptly after rainfall or snowmelt. Superposed on base runoff, it forms the folk of the hydrograph of a flood. See also surface runoff. The terms base runoff and direct runoff are time classifications of runoff. The terms ground-water runoff and surface runoff are classifications according to source.\citep{LANGBEIN.1960}

\textbf{\emph{Infiltration capacity:}} The maximum rate at which the soil, when in a given condition, can absorb falling rain or melting snow.\citep{Horton.1933}

\textbf{\emph{Infiltration:}} The flow of a fluid into a substance through pores or small openings. It connotes flow into a substance in cont distinction to the word percolation, which connotes flow through a porous sub- stance.\citep{Horton.1941}

\textbf{\emph{Overland flow:}} The flow of rainwater or snowmelt over the land surface toward stream channels. After it enters a stream, it becomes runoff.\citep{LANGBEIN.1960}

\textbf{\emph{Streamflow:}} The discharge that occurs in a natural channel. Although the term discharge can be applied to the flow of a canal, the word streamflow uniquely describes the discharge in a surface stream course. The term ``streamflow'' is more general than runoff, as streamflow may be applied to dis- charge whether or not it is affected by diversion or regulation.\citep{LANGBEIN.1960}

\textbf{\emph{Unit hydrograph}} The hydrograph of direct runoff from a storm uni- formly distributed ever the drain- age basin during a specified unit of time; the hydrograph is reduced in vertical scale to correspond to a volume of runoff o* 1 inch from the drainage basin. (After Am. Soc. Civil Engineers 1949, p.~105.)

In this layer PROCESS \protect\hyperlink{RUNOFF}{RUNOFF}, \protect\hyperlink{ROUTE}{ROUTE} and GROUP \textbf{\emph{Route}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
WaterSource & mm & Water Source for Routing, sometimes the same Data with the Runoff\\
\cline{1-3}
UHAll & -- & All the UH data for all of the Grids for Routr with IUH\\
\cline{1-3}
TypeGridID & -- & The grids type for Routr with IUH\\
\cline{1-3}
TransAll & -- & All of the transform Matrix for all of the Grids for Routr with IUH\\
\cline{1-3}
Store & mm & Store in the Route (for some Module)\\
\cline{1-3}
Gr4j\_UH1 & -- & UH form 1 only for Module ROUTE.Gr4j, made by the function\\
\cline{1-3}
Gr4j\_UH2 & -- & UH form 1 only for Module ROUTE.Gr4j\\
\cline{1-3}
StaFlow & m3/s & Station Flow in the seted grid\\
\hline
\end{tabular}
\end{table}

And \textbf{\emph{GeoData}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
Latitude & deg & Latitude\\
\cline{1-3}
Elevation & m & Elevation\\
\hline
\end{tabular}
\end{table}

\hypertarget{Subsurface1}{%
\subsection{Subsurface (Subsur)}\label{Subsurface1}}

\textbf{\emph{Field-moisture capacity:}} The quantity of water which can be permarently retained in the soil in opposition to the downward pull of gnvity.\citep{Horton.1933}

\textbf{\emph{Field-moisture deficiency:}} The quantity of water, which would be required to restore the soil moisture to field-moisture capacity.\citep{Horton.1933}

\textbf{\emph{Field-moisture:}} Water diffused in the soil, the upper part of the zone of aeration from which water is discharged by the trans- piration of plants or by soil evap- oration. See Field-moisture ca- pacity and Field-moisture defi- ciency.

In this layer PROCESS \protect\hyperlink{InfiltratRat}{InfiltratRat}, \protect\hyperlink{Infiltration}{Infiltration} and GROUP \textbf{\emph{Infilt}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
Infiltration & mm & Infiltration\\
\cline{1-3}
InfiltrationRat & mm & Infiltration Rate (for some INFITRATION Module)\\
\cline{1-3}
InfiltrationRateMax & mm & Maximal Infiltration Rate (for some INFITRATION Module)\\
\hline
\end{tabular}
\end{table}

And \textbf{\emph{SoilData}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
Porosity & 100\% & Soil Porosity, not greater than 1\\
\cline{1-3}
SaturatedConductivity & m/s & Soil Saturated Conductivity\\
\cline{1-3}
Conductivity & m/s & Soil actual Conductivity\\
\cline{1-3}
WettingFrontSuction & m/s & Wetting Front Suction\\
\hline
\end{tabular}
\end{table}

\hypertarget{Ground1}{%
\subsection{Ground}\label{Ground1}}

\textbf{\emph{Base flow / runoff:}} Sustained or fair weather runoff. In most streams, base base flow is composed largely of ground water effluent. (Langbein and others, 1947, p.~6.) The term base flow is often used in the same sense as base runoff. However, the distinction is the same as that between stream flow and runoff. When the concept in the terms base flow and base runoff is that of the natural flow in a stream, base runoff is the logical term.

\textbf{\emph{Groundwater:}} Water in the ground that is in the zone of saturation, from which wells, springs, and ground-water runoff are supplied. (After Meinzer, 1949, p.~38r,)

In this layer PROCESS \protect\hyperlink{GROUNDWATER}{GROUNDWATER} and GROUP \textbf{\emph{Ground}} show in the following table:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
MoistureVolume & mm & Moisture volume\\
\cline{1-3}
MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\cline{1-3}
ZoneMoistureVolume & mm & Moisture volume, when the Ground is in more than one Layer divided\\
\cline{1-3}
ZoneDepth & mm & Ground Depth, , when the Ground is in more than one Layer divided\\
\cline{1-3}
BaseFlow & mm & Base Flow\\
\cline{1-3}
MoistureCapacity & mm & Moisture Capacity\\
\cline{1-3}
Depth & mm & Ground Depth\\
\cline{1-3}
Overflow & mm & Overflow, when the caculated water volume greater than Capacity\\
\cline{1-3}
Runoff & mm & Runoff, it will be more wert, when the Runoff is in different form divided\\
\hline
\end{tabular}
\end{table}

Except the above data GROUP, the \textbf{\emph{TimeData}} describe the time information:

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l}
\hline
Variable & Unit & Description\\
\hline
NDay & -- & Day nummer in one year\\
\hline
\end{tabular}
\end{table}

\hypertarget{important-elements-of-edhm}{%
\section{Important ELements of EDHM}\label{important-elements-of-edhm}}

\includegraphics{fig/EDHM_element.png}

In addition to the PROCESS, MODULE, MODEL there are also some other concept oabout EDHM, some like:

The arguments of a MODULE of include: \textbf{InData} and \textbf{Param}

\textbf{InData} is a list of all VARIABLE the MODULE needed, like previous section explained the VARIABLEs must putted in the GROUP.

\textbf{Pram} is the parameter list of all the empirical parameters (different as function arguments) of the MODULE.

You can check the MODULE needed VARIABLE (InData) and parameters (Param) with ``Data\_'' + MODULE name in R, some like \texttt{Data\_ReferenceET.Linacre} and the same time every Param give the suggested maximal and minimal value of the parameter in this MODULE.

You can also check the same content in the R Help windows with the MODULE name.

The output of the MODELUE have the similar structure like InData, the VARIABLE of \textbf{OutData} is also include in the ``\textbf{Data\_}'' dataset.

The \textbf{Data\_XXX} is a list that had added in EDHM package, the using about it will show in the next chapter.

Different from MODULE the input variable of MODEL will divided in to \textbf{TimeVariData} and \textbf{TimeInvariData}:

\textbf{TimeVariData} is the dataset of all VARIBLE those are variable in the time serie, e.g.~\emph{TAir}, \emph{Precipitation} and other meteorological data.

\textbf{TimeInvariData} is the dataset of all VARIBLE those are invariable in the time serie, e.g.~\emph{Latitude}, \emph{Elevation} and other geological and topography data.

The aim to the division is in order to convenient get the data of one time step. Actuly the most MODULE can only deal with on time step data, because the state is associated to the last time step, in the MODULE there are no timely loop, only in MODEL there is a loop.

But for some MODULE, those not contact with last time (e.g.~all MODULE in PROCESS \protect\hyperlink{ReferenceET}{ReferenceET}) or the full time data are known (e.g.~\protect\hyperlink{ROUTE.G2RES}{ROUTE.G2RES}), you can calculate the whole time series without loop.

\textbf{Step} is special unit in EDHM, in EDHM the time serise is divided into many equal time interval, one time interval is a \emph{Step}, the other units are given by \href{https://ucum.org/trac}{UCUM}. The most VAERIABLE like a rate, tempo those unit should be in {[}mm/Step{]}, will simplify as {[}mm{]}.

\hypertarget{develop}{%
\chapter{Model Use and Develop}\label{develop}}

\includegraphics{fig/EDHM_manual.png}

\hypertarget{model-module-structure-or-concept}{%
\section{MODEL / MODULE Structure or Concept}\label{model-module-structure-or-concept}}

Essentially a MODULE or a MODEL is a function in R, so in R a function make up of \textbf{name}, \textbf{arguments} and \textbf{body}, except the output \textbf{return} is also very important.

The \textbf{name} of a MODULE composed of a PROCESS and Method, lik \texttt{ReferenceET.Hargreaves}; the \textbf{name} of a MODEL composed of ``MODEL'' and a model method, like \texttt{MODEL.CVIC}.

The \textbf{arguments} of MODULE and MODEL are fest in the form ``InData, Param, \ldots{}'' for MODULE and ``TimeVariData, TimeInvariData, Param, \ldots{}'' for MODEL, so for the data transfer it's very important to set the same structure as ``Data\_'' dataset.

The \textbf{body} is the most important part of a function (MODULE or MODEL), generally it depended on the method.

The \textbf{OutData} (output) is also so important that not ignore, it must use the GROUP-VARIBLE type as InData.

Excepted, the reference and a data set, that make up of InData, Param and OutData can't be omitted, especially when the MODULE or MODEL are also for the other aviable.

\hypertarget{use-model-with-a-model-or-run_model}{%
\section{Use Model with a MODEL or Run\_MODEL}\label{use-model-with-a-model-or-run_model}}

\hypertarget{check-the-indata-list}{%
\subsection{Check the InData list}\label{check-the-indata-list}}

\hypertarget{data-preparation}{%
\subsection{Data Preparation}\label{data-preparation}}

\hypertarget{evaluate}{%
\subsection{Evaluate}\label{evaluate}}

\hypertarget{calibrate}{%
\subsection{Calibrate}\label{calibrate}}

\hypertarget{copuling-a-new-model-with-module}{%
\section{Copuling a new Model with MODULE}\label{copuling-a-new-model-with-module}}

\hypertarget{choose-module}{%
\subsection{Choose MODULE}\label{choose-module}}

\hypertarget{set-the-data-flow}{%
\subsection{Set the Data-FLow}\label{set-the-data-flow}}

\hypertarget{build-the-model-and-run_model}{%
\subsection{Build the MODEL and Run\_MODEL}\label{build-the-model-and-run_model}}

\hypertarget{design-a-new-module}{%
\section{Design a new MODULE}\label{design-a-new-module}}

\hypertarget{method-and-formula}{%
\subsection{Method and Formula}\label{method-and-formula}}

\hypertarget{coding-the-inhalt}{%
\subsection{Coding the Inhalt}\label{coding-the-inhalt}}

\hypertarget{set-inoutdata-and-parameter}{%
\subsection{Set In/OutData and Parameter}\label{set-inoutdata-and-parameter}}

\hypertarget{module}{%
\chapter{Basic Information of MODULEs}\label{module}}

Overview of \textbf{MODULEs}

\begin{table}[!h]
\centering
\begin{tabular}{l|l}
\hline
PROCESS & MODULE\\
\hline
ReferenceET & [ReferenceET.Hargreaves](\#ReferenceET.Hargreaves) | [ReferenceET.Linacre](\#ReferenceET.Linacre) | [ReferenceET.PenMon](\#ReferenceET.PenMon)\\
\cline{1-2}
ActualET & [ActualET.Gr4j](\#ActualET.Gr4j) | [ActualET.Vic](\#ActualET.Vic)\\
\cline{1-2}
SNOW & [SNOW.17](\#SNOW.17) | [SNOW.Ddf](\#SNOW.Ddf)\\
\cline{1-2}
BASEFLOW & [BASEFLOW.ARNO](\#BASEFLOW.ARNO)\\
\cline{1-2}
INTERCEPTION & [INTERCEPTION.Gash](\#INTERCEPTION.Gash)\\
\cline{1-2}
InfiltratRat & [InfiltratRat.GreenAmpt](\#InfiltratRat.GreenAmpt)\\
\cline{1-2}
Infiltration & [Infiltration.OIER](\#Infiltration.OIER) | [Infiltration.SER](\#Infiltration.SER)\\
\cline{1-2}
RUNOFF & [RUNOFF.Gr4j](\#RUNOFF.Gr4j) | [RUNOFF.OIER](\#RUNOFF.OIER) | [RUNOFF.SER](\#RUNOFF.SER) | [RUNOFF.Vic](\#RUNOFF.Vic) | [RUNOFF.VM](\#RUNOFF.VM)\\
\cline{1-2}
GROUNDWATER & [GROUNDWATER.Vic](\#GROUNDWATER.Vic)\\
\cline{1-2}
ROUTE & [ROUTE.G2RES](\#ROUTE.G2RES) | [ROUTE.Gr4j](\#ROUTE.Gr4j)\\
\hline
\end{tabular}
\end{table}

\hypertarget{ReferenceET}{%
\section{ReferenceET}\label{ReferenceET}}

\hypertarget{ReferenceET.Hargreaves}{%
\subsection{ReferenceET.Hargreaves}\label{ReferenceET.Hargreaves}}

This MODULE reference to the Literature: Reference Crop Evapotranspiration from Temperature \citep{GeorgeH.Hargreaves.1985}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & TAir & Cel & Average Air temperature in Timestep\\
\cline{2-4}
 & TMax & Cel & Maximal Air temperature in one day\\
\cline{2-4}
\multirow{-3}{*}{\raggedright\arraybackslash MetData} & TMin & Cel & Minimul Air temperature in one day\\
\cline{1-4}
GeoData & Latitude & deg & Latitude\\
\cline{1-4}
TimeData & NDay & -- & Day nummer in one year\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
PeriodN & 1 & 9999 & -- & The number of Step\\
\cline{1-5}
GridN & 1 & 9999 & -- & The nummber of effektive Grids\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Evatrans & RET & mm & Reference evapotranspiration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{ReferenceET.Linacre}{%
\subsection{ReferenceET.Linacre}\label{ReferenceET.Linacre}}

This MODULE reference to the Literature: A simple formula for estimating evaporation rates in various climates, using temperature data alone \citep{Linacre.1977}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & TAir & Cel & Average Air temperature in Timestep\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash MetData} & Actual\_vapor\_press & mPa & Actual vapor press\\
\cline{1-4}
 & Latitude & deg & Latitude\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash GeoData} & Elevation & m & Elevation\\
\cline{1-4}
TimeData & NDay & -- & Day nummer in one year\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
PeriodN & 1 & 9999 & -- & The number of Step\\
\cline{1-5}
GridN & 1 & 9999 & -- & The nummber of effektive Grids\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Evatrans & RET & mm & Reference evapotranspiration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{ReferenceET.PenMon}{%
\subsection{ReferenceET.PenMon}\label{ReferenceET.PenMon}}

This MODULE reference to the Literature: Step by Step Calculation of the Penman-Monteith Evapotranspiration (FAO-56) \citep{LincolnZotarelli.2014}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & TAir & Cel & Average Air temperature in Timestep\\
\cline{2-4}
 & TMax & Cel & Maximal Air temperature in one day\\
\cline{2-4}
 & TMin & Cel & Minimul Air temperature in one day\\
\cline{2-4}
 & RelativeHumidity & \% & Relative Humidity, not greater than 100\\
\cline{2-4}
 & WindSpeed & m/s & Average Wind Speed\\
\cline{2-4}
 & WindH & m & The hight to mess the WindSpeed\\
\cline{2-4}
\multirow{-7}{*}{\raggedright\arraybackslash MetData} & SunHour & h & Sunshine duration in one day\\
\cline{1-4}
 & Latitude & deg & Latitude\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash GeoData} & Elevation & m & Elevation\\
\cline{1-4}
TimeData & NDay & -- & Day nummer in one year\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
PeriodN & 1 & 9999 & -- & The number of Step\\
\cline{1-5}
GridN & 1 & 9999 & -- & The nummber of effektive Grids\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Evatrans & RET & mm & Reference evapotranspiration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{ActualET}{%
\section{ActualET}\label{ActualET}}

\hypertarget{ActualET.Gr4j}{%
\subsection{ActualET.Gr4j}\label{ActualET.Gr4j}}

This MODULE reference to the Literature: Improvement of a parsimonious model for streamflow simulation \citep{Perrin.2003}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Evatrans & RET & mm & Reference evapotranspiration\\
\cline{1-4}
Ground & MoistureVolume & mm & Moisture volume\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
Gr4j\_X1 & 0.1 & 9.99 & mm & NA\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Evatrans & AET & mm & Actual evapotranspiration\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{ActualET.Vic}{%
\subsection{ActualET.Vic}\label{ActualET.Vic}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & AerodynaResist & s/m & Aerodyna Resist\\
\cline{2-4}
 & ArchitecturalResist & s/m & Architectural Resist\\
\cline{2-4}
\multirow{-3}{*}{\raggedright\arraybackslash Aerodyna} & StomatalResist & s/m & Stomatal Resist\\
\cline{1-4}
Canopy & StorageCapacity & mm & Canopy Storage Capacity for Intercept and Evaporation from Canopy\\
\cline{1-4}
Evatrans & RET & mm & Reference evapotranspiration\\
\cline{1-4}
 & MoistureVolume & mm & Moisture volume\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\cline{1-4}
Intercept & Interception & mm & Interception in Canopy\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
SoilMoistureCapacityB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & EvaporationCanopy & mm & Evaporation from Canopy\\
\cline{2-4}
 & Transpiration & mm & Transpiration (water from Root layer of vegetation)\\
\cline{2-4}
\multirow{-3}{*}{\raggedright\arraybackslash Evatrans} & EvaporationLand & mm & Evaporation from Landsurface (sometimes cotain the Evaporation from Watersurface like Lake)\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{SNOW}{%
\section{SNOW}\label{SNOW}}

\hypertarget{SNOW.17}{%
\subsection{SNOW.17}\label{SNOW.17}}

This MODULE reference to the Literature: National Weather Service river forecast system: snow accumulation and ablation model \citep{Anderson.1973}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
MetData & TAir & Cel & Average Air temperature in Timestep\\
\cline{1-4}
 & Ice\_Volume & mm & Soild Ice Volume, not depth\\
\cline{2-4}
 & Liquid\_Volume & mm & Liquid Volume\\
\cline{2-4}
 & SN17\_ATI & -- & --\\
\cline{2-4}
\multirow{-4}{*}{\raggedright\arraybackslash Snow} & SN17\_HD & mm & --\\
\cline{1-4}
 & SnowFall & mm & Snow\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Prec} & RainFall & mm & Rain\\
\cline{1-4}
GeoData & Elevation & m & Elevation\\
\cline{1-4}
TimeData & NDay & -- & Day nummer in one year\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
SN17\_SCF & 0.70 & 1.40 & -- & Snowfall correction factor\\
\cline{1-5}
SN17\_MFMAX & 0.50 & 2.00 & mm/6hCel & Maximum melt factor considered to occur on June 21\\
\cline{1-5}
SN17\_MFMIN & 0.05 & 0.49 & mm/6hCel & Minimum melt factor considered to occur on December 21\\
\cline{1-5}
SN17\_UADJ & 0.03 & 0.19 & mm/6hCel & The average wind function during rain-on-snow periods\\
\cline{1-5}
SN17\_NMF & 0.05 & 0.50 & mm/6hCel & Maximum negative melt factor\\
\cline{1-5}
SN17\_TIPM & 0.10 & 1.00 & -- & Antecedent snow temperature index\\
\cline{1-5}
SN17\_PXTEMP & -2.00 & 2.00 & Cel & Temperature that separates rain from snow\\
\cline{1-5}
SN17\_MBASE & 0.00 & 1.00 & Cel & Base temperature for non-rain melt factor\\
\cline{1-5}
SN17\_PLWHC & 0.02 & 0.30 & -- & Percent of liquid–water capacity\\
\cline{1-5}
SN17\_DAYGM & 0.00 & 0.30 & mm/d & Daily melt at snow–soil interface\\
\cline{1-5}
TimeStepSec & 1.00 & 9999.00 & s & Second pro Step\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & Ice\_Volume & mm & Soild Ice Volume, not depth\\
\cline{2-4}
 & Liquid\_Volume & mm & Liquid Volume\\
\cline{2-4}
 & SN17\_ATI & -- & --\\
\cline{2-4}
\multirow{-4}{*}{\raggedright\arraybackslash Snow} & SN17\_HD & mm & --\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{SNOW.Ddf}{%
\subsection{SNOW.Ddf}\label{SNOW.Ddf}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & MoistureVolume & mm & Moisture volume\\
\cline{1-4}
Snow & Volume & mm & Summe Volume of Ice and liquid water, not depth\\
\cline{1-4}
 & SnowFall & mm & Snow\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Prec} & RainFall & mm & Rain\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
Factor\_Day\_degree & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Snow & Volume & mm & Summe Volume of Ice and liquid water, not depth\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{BASEFLOW}{%
\section{BASEFLOW}\label{BASEFLOW}}

\hypertarget{BASEFLOW.ARNO}{%
\subsection{BASEFLOW.ARNO}\label{BASEFLOW.ARNO}}

This MODULE reference to the Literature: LARGE AREA HYDROLOGIC MODELING AND ASSESSMENT PART I: MODEL DEVELOPMENT \citep{Arnold.1998}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & MoistureVolume & mm & Moisture volume\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
ExponentARNOBase & 0 & 0 & -- & --\\
\cline{1-5}
ARNOBaseThresholdRadio & 0 & 0 & -- & --\\
\cline{1-5}
DrainageLossMax & 0 & 0 & -- & --\\
\cline{1-5}
DrainageLossMin & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & BaseFlow & mm & Base Flow\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{INTERCEPTION}{%
\section{INTERCEPTION}\label{INTERCEPTION}}

\hypertarget{INTERCEPTION.Gash}{%
\subsection{INTERCEPTION.Gash}\label{INTERCEPTION.Gash}}

This MODULE reference to the Literature: An analytical model of rainfall interception by forests \citep{Gash.1979}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Canopy & StorageCapacity & mm & Canopy Storage Capacity for Intercept and Evaporation from Canopy\\
\cline{1-4}
Evatrans & EvaporationCanopy & mm & Evaporation from Canopy\\
\cline{1-4}
Intercept & Interception & mm & Interception in Canopy\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
CoefficientFreeThroughfall & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Intercept & Interception & mm & Interception in Canopy\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{InfiltratRat}{%
\section{InfiltratRat}\label{InfiltratRat}}

\hypertarget{InfiltratRat.GreenAmpt}{%
\subsection{InfiltratRat.GreenAmpt}\label{InfiltratRat.GreenAmpt}}

This MODULE reference to the Literature: Drainage to a water table analysed by the Green-Ampt approach \citep{Youngs.1976}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & MoistureVolume & mm & Moisture volume\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & Depth & mm & Ground Depth\\
\cline{1-4}
 & Conductivity & m/s & Soil actual Conductivity\\
\cline{2-4}
 & WettingFrontSuction & m/s & Wetting Front Suction\\
\cline{2-4}
\multirow{-3}{*}{\raggedright\arraybackslash SoilData} & Porosity & 100\% & Soil Porosity, not greater than 1\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
GridN & 1 & 9999 & -- & NA\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Infilt & InfiltrationRat & mm & Infiltration Rate (for some INFITRATION Module)\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{Infiltration}{%
\section{Infiltration}\label{Infiltration}}

\hypertarget{Infiltration.OIER}{%
\subsection{Infiltration.OIER}\label{Infiltration.OIER}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Infilt & InfiltrationRat & mm & Infiltration Rate (for some INFITRATION Module)\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
InfiltrationRateB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Infilt & Infiltration & mm & Infiltration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{Infiltration.SER}{%
\subsection{Infiltration.SER}\label{Infiltration.SER}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureCapacity & mm & Moisture Capacity\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
SoilMoistureCapacityB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Infilt & Infiltration & mm & Infiltration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{RUNOFF}{%
\section{RUNOFF}\label{RUNOFF}}

\hypertarget{RUNOFF.Gr4j}{%
\subsection{RUNOFF.Gr4j}\label{RUNOFF.Gr4j}}

This MODULE reference to the Literature: Improvement of a parsimonious model for streamflow simulation \citep{Perrin.2003}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & MoistureVolume & mm & Moisture volume\\
\cline{1-4}
Evatrans & AET & mm & Actual evapotranspiration\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
Gr4j\_X1 & 0.1 & 9.99 & mm & NA\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & Runoff & mm & Runoff, it will be more wert, when the Runoff is in different form divided\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureVolume & mm & Moisture volume\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{RUNOFF.OIER}{%
\subsection{RUNOFF.OIER}\label{RUNOFF.OIER}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Infilt & InfiltrationRateMax & mm & Maximal Infiltration Rate (for some INFITRATION Module)\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
InfiltrationRateB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & Runoff & mm & Runoff, it will be more wert, when the Runoff is in different form divided\\
\cline{1-4}
Infilt & Infiltration & mm & Infiltration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{RUNOFF.SER}{%
\subsection{RUNOFF.SER}\label{RUNOFF.SER}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureVolume & mm & Moisture volume\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
SoilMoistureCapacityB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & Runoff & mm & Runoff, it will be more wert, when the Runoff is in different form divided\\
\cline{1-4}
Infilt & Infiltration & mm & Infiltration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{RUNOFF.Vic}{%
\subsection{RUNOFF.Vic}\label{RUNOFF.Vic}}

This MODULE reference to the Literature: A new surface runoff parameterization with subgrid-scale soil heterogeneity for land surface models \citep{Liang.2001}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureVolume & mm & Moisture volume\\
\cline{1-4}
Infilt & InfiltrationRat & mm & Infiltration Rate (for some INFITRATION Module)\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
SoilMoistureCapacityB & 0 & 0 & -- & --\\
\cline{1-5}
InfiltrationRateB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & Runoff & mm & Runoff, it will be more wert, when the Runoff is in different form divided\\
\cline{1-4}
Infilt & Infiltration & mm & Infiltration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{RUNOFF.VM}{%
\subsection{RUNOFF.VM}\label{RUNOFF.VM}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & MoistureCapacity & mm & Moisture Capacity\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & MoistureCapacityMax & mm & Maximal Moisture Capacity\\
\cline{1-4}
Infilt & InfiltrationRateMax & mm & Maximal Infiltration Rate (for some INFITRATION Module)\\
\cline{1-4}
Prec & Precipitation & mm & Precipitation, summe of rain and snow\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
SoilMoistureCapacityB & 0 & 0 & -- & --\\
\cline{1-5}
InfiltrationRateB & 0 & 0 & -- & --\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Ground & Runoff & mm & Runoff, it will be more wert, when the Runoff is in different form divided\\
\cline{1-4}
Infilt & Infiltration & mm & Infiltration\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{GROUNDWATER}{%
\section{GROUNDWATER}\label{GROUNDWATER}}

\hypertarget{GROUNDWATER.Vic}{%
\subsection{GROUNDWATER.Vic}\label{GROUNDWATER.Vic}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & ZoneMoistureVolume & mm & Moisture volume, when the Ground is in more than one Layer divided\\
\cline{2-4}
 & ZoneDepth & mm & Ground Depth, , when the Ground is in more than one Layer divided\\
\cline{2-4}
\multirow{-3}{*}{\raggedright\arraybackslash Ground} & BaseFlow & mm & Base Flow\\
\cline{1-4}
Infilt & Infiltration & mm & Infiltration\\
\cline{1-4}
Intercept & Interception & mm & Interception in Canopy\\
\cline{1-4}
 & Porosity & 100\% & Soil Porosity, not greater than 1\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash SoilData} & SaturatedConductivity & m/s & Soil Saturated Conductivity\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
GridN & 1 & 9999 & -- & The nummber of effektive Grids\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & Overflow & mm & Overflow, when the caculated water volume greater than Capacity\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Ground} & ZoneMoistureVolume & mm & Moisture volume, when the Ground is in more than one Layer divided\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{ROUTE}{%
\section{ROUTE}\label{ROUTE}}

\hypertarget{ROUTE.G2RES}{%
\subsection{ROUTE.G2RES}\label{ROUTE.G2RES}}

This MODULE reference to the Literature: none \citep{none}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & WaterSource & mm & Water Source for Routing, sometimes the same Data with the Runoff\\
\cline{2-4}
 & UHAll & -- & All the UH data for all of the Grids for Routr with IUH\\
\cline{2-4}
 & TypeGridID & -- & The grids type for Routr with IUH\\
\cline{2-4}
\multirow{-4}{*}{\raggedright\arraybackslash Route} & TransAll & -- & All of the transform Matrix for all of the Grids for Routr with IUH\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
PeriodN & 1 & 9999 & -- & The number of Step\\
\cline{1-5}
GridN & 1 & 9999 & -- & The nummber of effektive Grids\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
Route & StaFlow & m3/s & Station Flow in the seted grid\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{ROUTE.Gr4j}{%
\subsection{ROUTE.Gr4j}\label{ROUTE.Gr4j}}

This MODULE reference to the Literature: Improvement of a parsimonious model for streamflow simulation \citep{Perrin.2003}.

\textbf{\emph{InData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & WaterSource & mm & Water Source for Routing, sometimes the same Data with the Runoff\\
\cline{2-4}
 & Store & mm & Store in the Route (for some Module)\\
\cline{2-4}
 & Gr4j\_UH1 & -- & UH form 1 only for Module ROUTE.Gr4j, made by the function\\
\cline{2-4}
\multirow{-4}{*}{\raggedright\arraybackslash Route} & Gr4j\_UH2 & -- & UH form 1 only for Module ROUTE.Gr4j\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{Param}}

\begin{table}[!h]
\centering
\begin{tabular}{l|r|r|l|l}
\hline
Paramter & Min & Max & Unit & Description\\
\hline
Gr4j\_X2 & 0.1 & 9.99 & mm/Step & The catchment water exchange coe icient\\
\cline{1-5}
Gr4j\_X3 & 0.1 & 9.99 & mm & The one-day maximal capacity of the routing reservoir\\
\cline{1-5}
Gr4j\_X4 & 1.0 & 9.99 & mm/Step & The HU1 unit hydrograph time base\\
\cline{1-5}
time\_step\_i & 1.0 & 9999.00 & -- & The time Step index\\
\hline
\end{tabular}
\end{table}

\textbf{\emph{OutData}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l|l|l}
\hline
Group & Variable & Unit & Description\\
\hline
 & StaFlow & m3/s & Station Flow in the seted grid\\
\cline{2-4}
\multirow{-2}{*}{\raggedright\arraybackslash Route} & Store & mm & Store in the Route (for some Module)\\
\hline
\end{tabular}
\end{table}

Return to the \protect\hyperlink{module}{Overview} of MODULEs.

\hypertarget{model}{%
\chapter{Model}\label{model}}

\includegraphics{fig/EDHM_model.png}

\hypertarget{report-16.4}{%
\section{Report 16.4}\label{report-16.4}}

\begin{table}[!h]
\centering
\begin{tabular}{l|l}
\hline
PROCESS & MODULE\\
\hline
ReferenceET & [ReferenceET.Hargreaves](\#ReferenceET.Hargreaves) | [ReferenceET.Linacre](\#ReferenceET.Linacre) | [ReferenceET.PenMon](\#ReferenceET.PenMon)\\
\cline{1-2}
ActualET & [ActualET.Gr4j](\#ActualET.Gr4j) | [ActualET.Vic](\#ActualET.Vic)\\
\cline{1-2}
SNOW & [SNOW.17](\#SNOW.17) | [SNOW.Ddf](\#SNOW.Ddf)\\
\cline{1-2}
RUNOFF & [RUNOFF.Gr4j](\#RUNOFF.Gr4j) | [RUNOFF.OIER](\#RUNOFF.OIER) | [RUNOFF.SER](\#RUNOFF.SER) | [RUNOFF.Vic](\#RUNOFF.Vic) | [RUNOFF.VM](\#RUNOFF.VM)\\
\cline{1-2}
ROUTE & [ROUTE.G2RES](\#ROUTE.G2RES) | [ROUTE.Gr4j](\#ROUTE.Gr4j)\\
\hline
\end{tabular}
\end{table}

\hypertarget{snowmelt}{%
\subsection{Snowmelt}\label{snowmelt}}

Type 1 \textbf{Temperature}

\[SM=(T-T_s)\times c_f\]
where \(SM\) is the snowmelt {[}mm{]} (of water), \(cf\) is the factor of melt {[}mm/Cel d{]}, T is the mean air temperature {[}Cel{]}, and \(T_s\) is a threshold temperature value {[}Cel{]}.

Type 2 \textbf{Energy (radition)}

\[SM=\frac{ISR\times(1-\alpha)+C_0+C_1\times T}{\rho \times L_f}\]
where \(\alpha\) is the snow albedo, \(ISR\) is the incoming shortwave radiation {[}W/m2{]}, \(C_0\) and \(C_1\) are factors accounting for the temperature-dependent energy fluxes ({[}W/m2{]} and {[}W/m2Cel{]}, respectively), \(\rho\) is the density of snow {[}kg/m3{]}, and \(L_f\) is the fusion latent heat {[}J/kg{]}.

More information see the literarure \citep{Troin.2018}

\hypertarget{classical-vic}{%
\section{Classical VIC}\label{classical-vic}}

Chapter \ref{ReferenceET}

\protect\hyperlink{ReferenceET}{Section}

\hypertarget{gr4j}{%
\section{GR4J}\label{gr4j}}

\hypertarget{final-words}{%
\chapter{Final Words}\label{final-words}}

We have finished a book.

  \bibliography{book.bib,packages.bib}

\end{document}
