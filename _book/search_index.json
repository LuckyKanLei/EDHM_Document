[["index.html", "Editable Distributed Hydrological Model The Document and the EDHM Package The Document EDHM", " Editable Distributed Hydrological Model Kan Lei 2021-04-20 The Document and the EDHM Package The Document This document is the use guide for EDHM and some other concept about the hydrological models (HM) building. In Chapter 1 explain the basic concept of hydrological cycle and the important concept and idea of EDHM. In chapter 2 show the workflow of using a hydrological model with EDHM and the way to explain a new model. Chapter 3 and 4 show the basic information, e.g. input data, parameters and output data of every module or model. EDHM EDHM is a R package for hydrological models in order to simplify the models building, specially the distributed hydrological model. In the package contain many complete MODEL that can used directly, and many MODULE that can a new MODEL to building. All of the MODELs and MODULEs are build with matrix-arithmetic, that can good deal with the distributed situation. In the package there are many tools to calibrate the parameters or build a new MODEL or a new MODULE. The Package is only in GitHub published, for the first time use, please install the package EDHM and HMtools use the following code: install.packages(&quot;devtools&quot;) devtools::install_github(&quot;LuckyKanLei/HMtools&quot;) devtools::install_github(&quot;LuckyKanLei/EDHM&quot;) The summary of the Processes and Modules show in the following table: PROCESS MODULE ReferenceET ReferenceET.Hargreaves | ReferenceET.Linacre | ReferenceET.PenMon ActualET ActualET.Gr4j | ActualET.Vic SNOW SNOW.17 | SNOW.Ddf BASEFLOW BASEFLOW.ARNO INTERCEPTION INTERCEPTION.Gash InfiltratRat InfiltratRat.GreenAmpt Infiltration Infiltration.OIER | Infiltration.SER RUNOFF RUNOFF.Gr4j | RUNOFF.OIER | RUNOFF.SER | RUNOFF.Vic | RUNOFF.VM GROUNDWATER GROUNDWATER.Vic ROUTE ROUTE.G2RES | ROUTE.Gr4j "],["base.html", "Chapter 1 Basic Concept 1.1 Important Elements of EDHM 1.2 Basic Concept of Hydrological Cycle", " Chapter 1 Basic Concept Before using of the EDHM it’s very important to know the basic concept and primary idea about EDHM. 1.1 Important Elements of EDHM In EDHM the two mostly characters are modularization and vectorization-arithmetic, modularization focus on the coupling of the different modules of the hydrological processes, benefit by the modularization it’s very convenience to change the method of process, what means the editable model; vectorization-arithmetic is very useful for the distributed hydrological model, it can greatly short the calculate time, especially when there are many grids (calculate units). The water cycle of the Earth system and its variability at global, regional and local scales are influenced by a range of processes and mutual interactions, feedback mechanisms and as well as affected by anthropogenic processes.(Rast, Johannessen, and Mauser 2014) In EDHM a PROCESS is the mapping from those hydrological processes in a digital from, at the same time it’s also the group (set) name of the some MODULEs those haven the same problem to solve and same aims, and a MODULE is the definite method of a PROCESS, it can also undersatnd as: MODULE = PROCESS \\(\\times\\) Method For example SNOW is PROCESS mapping the process that snow melting, accumulate and the state variety, SNOW.17 is then the true function that you can call in R, with the method by Andrson(Anderson 1973) forward. The PROCESS based on the hydrological processes, but sometimes a little different, due to the manual calculate factors in the lang time, some like evapotranspiration is a typical hydrological process, but in EDHM es is diveded into ReferenceET (reference evapotranspiration) and ActualET (actual evapotranspiration) two parts, because the most conceptual models calculate evapotranspiration in the two steps. In the following section will show the meaning of hydrological processes and the mapped PROCESS. MODEL is a coupled complete process with some subprocesses (also possible only one process), in EDHM is a true function to simulation the designed model with definite methods. It’s also a set of MODULEs, those realize different process and correctly by the physical process, it can also undersatnd as: MODEL = \\(\\sum\\) MODULE\\(_i\\) In addition to the PROCESS, MODULE, MODEL there are also some other concept oabout EDHM, some like: function, Run_MODEL, EVALUTE and KALIBRATE. Essentially a MODULE or a MODEL is a function in R, so in R a function make up of name, arguments and body, except the output return / value is also very important. The name of a MODULE composed of a PROCESS and Method, lik ReferenceET.Hargreaves; the name of a MODEL composed of “MODEL” and a model method, like MODEL.CVIC. The arguments of MODULE and MODEL are fest in the form “InData, Param, …” for MODULE and “TimeVariData, TimeInvariData, Param, …” for MODEL, so for the data transfer it’s very important to set the same structure as “Data_” dataset. The body is the most important part of a function (MODULE or MODEL), generally it depended on the method. The OutData (value) is also so important that not ignore, it must use the GROUP-VARIBLE type as InData. Excepted, the reference and a data set, that make up of InData, Param and OutData can’t be omitted, especially when the MODULE or MODEL are also for the other aviable. The arguments of a MODULE of include: InData and Param The VARIABLE is the data those describe the state or character of the environment and the volume or character of water in different process. And in order to quickly find the VARIABLE and avoid the duplicate name of VARIABLE, the GROUP is like the folder of VARIABLE designed, for example in GROUP Evatrans (evapotranspiration) include the VARIABLEs RET (reference evapotranspiration), AET (actual evapotranspiration) and so on. In EDHM the VARIABLE saved as common type of for time-invariable VARIABLE, it depend on the MODEL or MODULE or “t_vari.array” that base on “array” type for time-variable VARIABLE. The first dimension must be the time-dimension. When it also has heterogeneity in horizontal spatial space, the second dimension slways is the space-dimension. In EDHM the spatial data are divided in to many GRID, in the using of MODEL the spatial contact between the GRIDs will ignored, all of GRIDs must have a ID (index) form 1 to number of GRIDs. But it’s not important, how to divide the research region. For some VARIABLE there are also different layers, it can put in third demenision. VARIABLE are putted in the GROUP InData is a list of all VARIABLE the MODULE needed, like previous section explained the VARIABLEs must putted in the GROUP. Pram is the parameter list of all the empirical parameters (different as function arguments) of the MODULE. You can check the MODULE needed VARIABLE (InData) and parameters (Param) with “Data_” + MODULE name in R, some like Data_ReferenceET.Linacre and the same time every Param give the suggested maximal and minimal value of the parameter in this MODULE. You can also check the same content in the R Help windows with the MODULE name. The output of the MODELUE have the similar structure like InData, the VARIABLE of OutData is also include in the “Data_” dataset. The Data_XXX is a list that had added in EDHM package, the using about it will show in the next chapter. Different from MODULE the input variable of MODEL will divided in to TimeVariData and TimeInvariData: TimeVariData is the dataset of all VARIBLE those are variable in the time serie, e.g. TAir, Precipitation and other meteorological data. TimeInvariData is the dataset of all VARIBLE those are invariable in the time serie, e.g. Latitude, Elevation and other geological and topography data. The aim to the division is in order to convenient get the data of one time step. Actuly the most MODULE can only deal with on time step data, because the state is associated to the last time step, in the MODULE there are no timely loop, only in MODEL there is a loop. But for some MODULE, those not contact with last time (e.g. all MODULE in PROCESS ReferenceET) or the full time data are known (e.g. ROUTE.G2RES), you can calculate the whole time series without loop. Step is special unit in EDHM, in EDHM the time serise is divided into many equal time interval, one time interval is a Step, the other units are given by UCUM. The most VAERIABLE like a rate, tempo those unit should be in [mm/Step], will simplify as [mm]. The using of a MODEL is the basic, but the Param (parameters) import base on the name-index not number-index, so it’s essencially to make a Run_MODELL to transfer the parameters, especially when use auto calibration program. In a Run_MODELL function you can set the parameters those need to calibrate or not. EVALUTE is a process by the application of hydrological model, use the mathematical form to evaluate the results of simulation, scilicet the . The sime time it is slso the basic for CALIBRATE, the most effective method for CALIBRATE is calculated into a number (efficiency), like NSE (Nash-Sutcliffe efficiency), KGE (Kling-Gupta Efficiency). CALIBRATE is also a process by the application of hydrological model, in this process the parameters of the model are varied to minimize the difference between simulation result and observed data. 1.2 Basic Concept of Hydrological Cycle The hydrological cycle is composed of different components, which include evaporation from water surfaces and bare soil, evapotranspiration from vegetated land, transport of water vapour in the atmosphere, cloud droplet formation and cloud dynamics, the mechanisms leading to liquid and solid precipitation, the movement of water and change in soil moisture in the unsaturated soil, including root dynamics, surface and river run-off, and groundwater flow.(Rast, Johannessen, and Mauser 2014) Also from (LANGBEIN and ISERI 1960): A convenient term to denote the circulation of water from the sea, through the atmos- phere, to the land; and thence, with many delays, back to the sea by overland and subterranean routes, and in part by way of the atmosphere; also the many short circuits of the water that is re- turned to the atmosphere without reaching the see. The whole cycle will spilt by the vertical layer in six layers which are Atmosphe, Snow, Canopy, Surface, Subsurface and Ground. There indeed are not the complete hydrological cycle components, limited by the first stage, in the first stage will focus on the conceptual models. 1.2.1 Atmosphere (Atmos) In the Atmosphere major occur the process precipitation and part of the evapotranspiration, the concept of the evapotranspiration will show in section 1.2.3 in Canopy group. Precipitation: As used in hydrology, precipitation is the discharge of water, in liquid or solid state, out of the atmosphere, generally upon a land or water surface. It is the common process by which atmospheric water becomes surface or subsurface water * * *. The term “precipitation” is also commonly used to designate the quantity of water that is precipitated. (Meinzer, 1923, p. 15.) Precipitation includes rainfall, snow, hail, and sleet, and is therefore a more general terr than rainfall. Effective precipitation: 1. That part of the precipitation that produces runoff. 2. A weighted average of current and antecedent precipitation that is “effective” in correlating with runoff.(LANGBEIN and ISERI 1960) The two most important forms of precipitation are rainfall and snowfall, the other form will not considered in general situation or simulation. Rainfall: The quantity of water that falls as rain only. Not synonymous with precipitation. Snowfall: A form of precipitation composed of ice crystals. In this layer PROCESS PRECDicid and GROUP Prec show in the following Table: Variable Unit Description Precipitation mm Precipitation, summe of rain and snow SnowFall mm Snow RainFall mm Rain And the typical meteorological data set MetData Variable Unit Description TAir Cel Average Air temperature in Timestep TMax Cel Maximal Air temperature in one day TMin Cel Minimul Air temperature in one day Actual_vapor_press mPa Actual vapor press RelativeHumidity % Relative Humidity, not greater than 100 WindSpeed m/s Average Wind Speed WindH m The hight to mess the WindSpeed SunHour h Sunshine duration in one day 1.2.2 Snow waterequivalent of snow: Amount of water that would be obtained if the snow should be completely melted. Water content may be merely the amount of liquid water in the snow at the time of observation. (Wilson, 1942a, p. 153-154.) In this layer PROCESS SNOW and GROUP Snow show in the following Table: Variable Unit Description Ice_Volume mm Soild Ice Volume, not depth Liquid_Volume mm Liquid Volume SN17_ATI – – SN17_HD mm – Volume mm Summe Volume of Ice and liquid water, not depth 1.2.3 Canopy Condensation: The process by which water changes from the vapor state into the liquid or solid state. It is the reverse of evaporation.(LANGBEIN and ISERI 1960) Evaporation:The process by which water is changed from the liquid or the solid state into the vapor state. In hydrology, evaporation is vaporization that takes place at a temperature below the boiling point.(LANGBEIN and ISERI 1960) Transpritation: The quantity of water absorbed and transpired and used directly in the bulling of plant tissue, in a specified time. It does not include soil evaporation. (After Blaney, I951a, p. 4.) The process by which water vapor escapes from the living plant, principally the leaves, and enters the atmosphere. As considered practically, transpiration also includes guttation. (Lee, 1949, p. 260.) Evapotranspiration: Water withdrawn from a land area by evaporation from water surfaces and moist, soil and plant transpiration.(LANGBEIN and ISERI 1960) Relative evaporation: The ratio of the rate of evaporation from a land or water surface in contact with the atmosphere, to the evaporativity under existing atmospheric conditions. It is the ratio of actual to potential rate of evaporation, generally stated as a percentage. (Derived from Meinzer, 1923, p. 14.) The opportunity for a given rate of evaporation to continue is determined by the available moisture supply. (Meyer, 1928, p. 244.) Potential evaporation: Water loss that will occur if at no time there is a deficiency of water in the soil for use of vegetation. (Thornthwaite, 1944, p. 687.) Interception: The process and the amount of rain or snow stored on leaves and branches and eventually evaporated back to the air. Interception equals the precipitation on the vegetation minus stem flow and throughfall (after Hoover, 1953, p. 1.) In this layer PROCESS ReferenceET, ActualET, INTERCEPTION and GROUP Evatrans show in the following table: Variable Unit Description RET mm Reference evapotranspiration EvaporationCanopy mm Evaporation from Canopy AET mm Actual evapotranspiration Transpiration mm Transpiration (water from Root layer of vegetation) EvaporationLand mm Evaporation from Landsurface (sometimes cotain the Evaporation from Watersurface like Lake) Intercept show in the following table: Variable Unit Description Interception mm Interception in Canopy Canopy show in the following table: Variable Unit Description StorageCapacity mm Canopy Storage Capacity for Intercept and Evaporation from Canopy And Aerodyna show in the following table: Variable Unit Description AerodynaResist s/m Aerodyna Resist ArchitecturalResist s/m Architectural Resist StomatalResist s/m Stomatal Resist 1.2.4 Surface (Runoff, Route) Runoff: That part of the precipitation that appears in surface streams. It is the same as streamflow unaffected by artificial diversions, storage, or other works of man in or on the stream channels. Runoff may be classified as follows: Classification as to speed of appearance after rain- fall or snow melting: Direct runoff Base runoff Classification as to source: Surface runoff Storm seepage Groundwater runoff. Surface runoff: That part of the runoff which travels over the soil surface to the nearest stream channel. It is also defined as that part of the runoff of a drainage basin that has not passed beneath the surface since precipitation. The term is misused when applied in the sense of direct runoff. See also, Runoff, Overland flow, Direct runoff, Groundwater runoff, and Surface water. Direct runoff: The runoff entering stream channels promptly after rainfall or snowmelt. Superposed on base runoff, it forms the folk of the hydrograph of a flood. See also surface runoff. The terms base runoff and direct runoff are time classifications of runoff. The terms ground-water runoff and surface runoff are classifications according to source.(LANGBEIN and ISERI 1960) Infiltration capacity: The maximum rate at which the soil, when in a given condition, can absorb falling rain or melting snow.(Horton 1933) Infiltration: The flow of a fluid into a substance through pores or small openings. It connotes flow into a substance in cont distinction to the word percolation, which connotes flow through a porous sub- stance.(Horton 1941) Overland flow: The flow of rainwater or snowmelt over the land surface toward stream channels. After it enters a stream, it becomes runoff.(LANGBEIN and ISERI 1960) Streamflow: The discharge that occurs in a natural channel. Although the term discharge can be applied to the flow of a canal, the word streamflow uniquely describes the discharge in a surface stream course. The term “streamflow” is more general than runoff, as streamflow may be applied to dis- charge whether or not it is affected by diversion or regulation.(LANGBEIN and ISERI 1960) Unit hydrograph The hydrograph of direct runoff from a storm uni- formly distributed ever the drain- age basin during a specified unit of time; the hydrograph is reduced in vertical scale to correspond to a volume of runoff o* 1 inch from the drainage basin. (After Am. Soc. Civil Engineers 1949, p. 105.) In this layer PROCESS RUNOFF, ROUTE and GROUP Route show in the following table: Variable Unit Description WaterSource mm Water Source for Routing, sometimes the same Data with the Runoff UHAll – All the UH data for all of the Grids for Routr with IUH TypeGridID – The grids type for Routr with IUH TransAll – All of the transform Matrix for all of the Grids for Routr with IUH Store mm Store in the Route (for some Module) Gr4j_UH1 – UH form 1 only for Module ROUTE.Gr4j, made by the function Gr4j_UH2 – UH form 1 only for Module ROUTE.Gr4j StaFlow m3/s Station Flow in the seted grid And GeoData show in the following table: Variable Unit Description Latitude deg Latitude Elevation m Elevation 1.2.5 Subsurface (Subsur) Field-moisture capacity: The quantity of water which can be permarently retained in the soil in opposition to the downward pull of gnvity.(Horton 1933) Field-moisture deficiency: The quantity of water, which would be required to restore the soil moisture to field-moisture capacity.(Horton 1933) Field-moisture: Water diffused in the soil, the upper part of the zone of aeration from which water is discharged by the trans- piration of plants or by soil evap- oration. See Field-moisture ca- pacity and Field-moisture defi- ciency. In this layer PROCESS InfiltratRat, Infiltration and GROUP Infilt show in the following table: Variable Unit Description Infiltration mm Infiltration InfiltrationRat mm Infiltration Rate (for some INFITRATION Module) InfiltrationRateMax mm Maximal Infiltration Rate (for some INFITRATION Module) And SoilData show in the following table: Variable Unit Description Porosity 100% Soil Porosity, not greater than 1 SaturatedConductivity m/s Soil Saturated Conductivity Conductivity m/s Soil actual Conductivity WettingFrontSuction m/s Wetting Front Suction 1.2.6 Ground Base flow / runoff: Sustained or fair weather runoff. In most streams, base base flow is composed largely of ground water effluent. (Langbein and others, 1947, p. 6.) The term base flow is often used in the same sense as base runoff. However, the distinction is the same as that between stream flow and runoff. When the concept in the terms base flow and base runoff is that of the natural flow in a stream, base runoff is the logical term. Groundwater: Water in the ground that is in the zone of saturation, from which wells, springs, and ground-water runoff are supplied. (After Meinzer, 1949, p. 38r,) In this layer PROCESS GROUNDWATER and GROUP Ground show in the following table: Variable Unit Description MoistureVolume mm Moisture volume MoistureCapacityMax mm Maximal Moisture Capacity ZoneMoistureVolume mm Moisture volume, when the Ground is in more than one Layer divided ZoneDepth mm Ground Depth, , when the Ground is in more than one Layer divided BaseFlow mm Base Flow MoistureCapacity mm Moisture Capacity Depth mm Ground Depth Overflow mm Overflow, when the caculated water volume greater than Capacity Runoff mm Runoff, it will be more wert, when the Runoff is in different form divided Except the above data GROUP, the TimeData describe the time information: Variable Unit Description NDay – Day nummer in one year References "],["develop.html", "Chapter 2 Model Use and Develop 2.1 Basic Use of a complete MODELL 2.2 Coupling a new Model with MODULE 2.3 Design a new MODULE", " Chapter 2 Model Use and Develop 2.1 Basic Use of a complete MODELL 2.1.1 RUn a MODEL The using of a MODEL will summarized as four steps: Get the InData &amp; Param list by run Data_MODEL.XXX in R, the list of “Data_” is structured as: Prepare the data and transfer into EDHM form and confirm a parameter set. Please must mark the time-variable and time-invariable VARIABLEs. Please use Data_XXX$InData$GROUP$VARIABLE check the VARIABLE structure, when the VARIABLE is not normal. Input the prepared data to InData and Param. For the time-variable VARIBLE must put into “TimeVari”, some like “VARIABLE 1, 2” belong to “GROUP 1” and time-variable, “VARIABLE 3” belong to also “GROUP 1” but time-invariable. Then they will be structured as: The code for this exemple like: TimeVari &lt;- t_vari.hm.list() TimeVari$GROUP1$VARIABLE1 &lt;- mydata1 TimeVari$GROUP1$VARIABLE2 &lt;- mydata2 TimeVari$GROUP2$VARIABLE4 &lt;- mydata3 TimeInVari &lt;- hm.list() TimeInVari$GROUP1$VARIABLE3 &lt;- mydata4 Param &lt;- list() Param$Paramter1 &lt;- myparam1 Param$Paramter2 &lt;- myparam2 Run the MODEL. my_simu &lt;- MODELL.XXX(TimeVari, TimeInVari, Param) 2.1.2 set a Run_MODEL In EDHM the parameters are index with the parameters name, but when we calibrate the parameters, we set the parameters in a vector, also for some research not all of the parameters need to calibrate, so there is a setting about parameters from vector transfer to list. There shows the function Run_MODEL.SERR: Run_Model.SERR &lt;- function(TimeVariData, TimeInvariData, Param, ParamterCalibrate){ ## 1.0 snow## Param$Max_Snow_T = ParamterCalibrate[1] Param$Min_Snow_T = ParamterCalibrate[2] Param$Factor_Day_degree = ParamterCalibrate[3] ## 2.7-12 [mm] Param$Base_T = ParamterCalibrate[4] ## -2-5.5 [Cel] ## 1.1 ET ## Param$CanopyCapacity = ParamterCalibrate[5] Param$Coeff_ET_Capacity_Attenuat = ParamterCalibrate[6] ## 1.2 Runoff ## Param$Threshold_Runoff = ParamterCalibrate[7] Param$Ratio_Runoff = ParamterCalibrate[8] Param$Ratio_GW_Storage = ParamterCalibrate[9] Param$Coeff_GW_Storage_Attenuat = ParamterCalibrate[10] ## 1.3 Route ## Param$UPPaList = ParamterCalibrate[11:17] Result_ &lt;- MODEL.SERR(TimeVariData, TimeInvariData, Param) Result &lt;- Result_$Route$StaFlow return(Result) } The workflow is show in the following figure: 2.1.3 Evaluate Usually bye EVALUTE evalute the simulation results, but when we kalibrate the parameters, the EVALUTE evalute actully the parameters, those need to calibrate, so the EVALUTE based on the Run_MODEL. The data flow is show in the following figure: The EVALUTE functions is very easy to code, and the R Package hydroGOF (Mauricio Zambrano-Bigiarini 2020) is also recommend, in that there are some commen evalute methods for hydrological field, some like NSE, KGE, mae and soon. EVALUTE() is a function in EDHM, by setting EVALUTE(..., fct_Evaluate = NSE) set the evaluate method. The argument fct_Evaluate require a function, so give it just the function name without the quotation marks into a charater. 2.1.4 Calibrate The CALIBRATE help us choose the best parameter-set from a range, CALIBRATE will by the goodness of evaluate results and some algorithms to choose the parameters, at the end of algorithms find the best parameters-set, the “it” thinks. The data flow is show in the following figure: The R package mcga (Satman 2018) is recommend to calibrate, it is a Machine coded genetic algorithm to calibrate multi-parameters problem. mcga2() is the main function, this function require at least three arguments: fitness a function that can return a value to evaluate the parameters-set, min minimal parameters-set in vector, max maximal parameters-set in vector, and other arguments those fitness require. The fitness in EDHM is just the function EVALUTE(). For example: Fitness_GA = mcga2(fitness = EVALUATE, fct_Run_Model = Run_Model.SERR, TimeVariData = TimeVariData_run, TimeInvariData = TimeInvariData, Paramter_fest = Param_Base, Observe = Observe_run, warmUPN = 500, fct_Evaluate = KGE, min = ParamterCalibrateMin, max = ParamterCalibrateMax, popSize = 15, maxiter = 18) 2.1.5 Check the InData list After the preparation of data must check the data, weather there is NA or other unlogical data. The check tools will provide in the fast future. 2.2 Coupling a new Model with MODULE Generally researcher design a model for a basin or some specific environment, so in a new research region, we can use one model, the designed for this kind of basin or watershed and calibrate the empirical parameters. But sometimes by the calibrate of parameters can also not solve the problem, so researcher need change some of process to promote the simulation. In EDHM researcher are can use many MODULEs to build a new MODEL. The available PROCESSes and MODELs is show in the table. The coupling of a new MODEL will summarized as six steps: In this section a example MODEL.GR4J will show for explain. 2.2.1 Choose MODULE After the new designed model, there will required some PROCESSes, check the PROCESS and MODULE table and choose the relevant Methods to those PROCESS, also say the MODULEs. In this table you can click the MODULE name check the InData, Param and OutData in order to better understand the MODULE, also the literature of this Method is accessible. The MODULEs ReferenceET.Hargreaves, ActualET.Gr4j, RUNOFF.Gr4j and ROUTE.Gr4j are selected. 2.2.2 Set the Order Every PROCESS (MODULE) have the clear physical meaning, so by those you should set a correct order of those MODULEs. The PROCESS ReferenceET is certainly before ActualET, and ROUTE is the end PROCESS of a rainfall-runoff model. So the MODULE will set as: ## ET ETOut &lt;- ActualET.Gr4j(InData, Param) # S2 ## Runoff RFOut &lt;- RUNOFF.Gr4j(InData, Param) # S2 ## Route RTOut &lt;- ROUTE.Gr4j(InData, Param) # S2 2.2.3 Deal with InData and Param “Data Space” and “Parameter List” are the data-flow of the MODEL, the “Data Space” will save all of the VARIABLEs, it can be readied by the MODULE and use the function left_merge() write the OutData of MODULE into it. In the running of MODEL the InData will set into StepData for every step. The step will divided into five sub-steps: Get the parameters from Param; [# S3-0] Initialize the StepData; [# S3-1] Set the initial boundary data; [# S3-2] Make loop for every step; [# S3-3] Merge the OutData into “Data Space” (StepData). [# S3-4] PeriodN &lt;- Param$PeriodN # S3-0 GridN &lt;- Param$GridN # S3-0 ## StepData StepData &lt;- new(&#39;hm.list&#39;) # S3-1 StepData$Ground$MoistureVolume &lt;- rep(0, GridN) # S3-2 StepData &lt;- left_merge(StepData, TimeInvariData) # S3-2 for(i in 1: PeriodN){ # S3-3 Param$time_step_i &lt;- i StepData &lt;- left_merge(StepData, TimeVariData[i]) # S3-4 ## ET ETOut &lt;- ActualET.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, ETOut) # S3-4 ## Runoff RFOut &lt;- RUNOFF.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RFOut) StepData$Route$WaterSource &lt;- StepData$Groud$Runoff * StepData$GridData$Area / Param$TimeStepSec / 1000 ## Route RTOut &lt;- ROUTE.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RTOut) # S3-4 } 2.2.4 Set OutData In EDHM which VARIABLE need to output are enable to choose, those are useful for research. The step will divided into two sub-steps: Initialize the OutData; [# S4-1] Transfer from StepData into OutData. [# S4-2] PeriodN &lt;- Param$PeriodN # S3-0 GridN &lt;- Param$GridN # S3-0 ## StepData StepData &lt;- new(&#39;hm.list&#39;) # S3-1 StepData$Ground$MoistureVolume &lt;- rep(0, GridN) # S3-2 StepData &lt;- left_merge(StepData, TimeInvariData) # S3-2 ## OutData OutData &lt;- new(&quot;t_vari.hm.list&quot;) # S4-1 OutData$Route$StaFlow &lt;- t_vari.array(0, c(PeriodN, GridN)) # S4-1 for(i in 1: PeriodN){ # S3-3 Param$time_step_i &lt;- i StepData &lt;- left_merge(StepData, TimeVariData[i]) # S3-4 ## ET ETOut &lt;- ActualET.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, ETOut) # S3-4 ## Runoff RFOut &lt;- RUNOFF.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RFOut) StepData$Route$WaterSource &lt;- StepData$Groud$Runoff * StepData$GridData$Area / Param$TimeStepSec / 1000 ## Route RTOut &lt;- ROUTE.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RTOut) # S3-4 OutData[i] &lt;- StepData # S4-2 } 2.2.5 Deal with middle VARIABLE The InData of MODULE naming by the regulation, that can clear many works, but there still are some VARIABLE those need to deal. In this Example, the Ground$Runoff is in [mm] calculated but Route$WaterSource require a unit [m3/s], so people must transfer the two VARIABLEs. ## Runoff RFOut &lt;- RUNOFF.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RFOut) StepData$Route$WaterSource &lt;- StepData$Groud$Runoff * StepData$GridData$Area / Param$TimeStepSec / 1000 # S5 ## Route RTOut &lt;- ROUTE.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RTOut) # S3-4 2.2.6 Name and Data_ At the end only require a name for this MODEL, most importantly please not forget make the Data_ dataset. MODEL.GR4J &lt;- function(TimeVariData, TimeInvariData, Param, ...) { PeriodN &lt;- Param$PeriodN # S3-0 GridN &lt;- Param$GridN # S3-0 ## StepData StepData &lt;- new(&#39;hm.list&#39;) # S3-1 StepData$Ground$MoistureVolume &lt;- rep(0, GridN) # S3-2 StepData &lt;- left_merge(StepData, TimeInvariData) # S3-2 ## OutData OutData &lt;- new(&quot;t_vari.hm.list&quot;) # S4-1 OutData$Route$StaFlow &lt;- t_vari.array(0, c(PeriodN, GridN)) # S4-1 for(i in 1: PeriodN){ # S3-3 Param$time_step_i &lt;- i StepData &lt;- left_merge(StepData, TimeVariData[i]) # S3-4 ## ET ETOut &lt;- ActualET.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, ETOut) # S3-4 ## Runoff RFOut &lt;- RUNOFF.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RFOut) StepData$Route$WaterSource &lt;- StepData$Groud$Runoff * StepData$GridData$Area / Param$TimeStepSec / 1000 # S5 ## Route RTOut &lt;- ROUTE.Gr4j(StepData, Param) # S2 StepData &lt;- left_merge(StepData, RTOut) # S3-4 OutData[i] &lt;- StepData # S4-2 } return(OutData) } 2.3 Design a new MODULE Not only the coupling of MODULEs but also design a new MODULE very easy with EDHM. And one point need to mark that the MODULE should support the vectorization-arithmetic. The workflow show in following figure: The design of a new MODULE will summarized as five steps: In this section will show the example ActualET.Gr4j. 2.3.1 Method and Formula The method and formulas for a PROCESS can collected from all kinds of books and literature. The calculate method of GR4J shows in the link. 2.3.2 Coding the body By the formulas can program the function body easily. judge_PbE &lt;- P &gt; E # S1 Pn &lt;- judge_PbE * (P - E) # S1 En &lt;- (!judge_PbE) * (E - P) # S1 Es &lt;- S * (2 - S / X1) * tanh(En / X1) / (1 + (1 - S / X1) * tanh(En / X1)) # S1 2.3.3 Set In/OutData and Parameter The most important of the design is the naming of InData and OutData, all of them should select from Pre_dataset, include the GROUP name and VARIABLE name, when the VARIABLE is only used for this MODULE, the naming is not rigid. X1 &lt;- Param$Gr4j_X1 # S2-1 E &lt;- InData$Evatrans$RET # S2-1 S &lt;- InData$Ground$MoistureVolume # S2-1 P &lt;- InData$Prec$Precipitation # S2-1 judge_PbE &lt;- P &gt; E # S1 Pn &lt;- judge_PbE * (P - E) # S1 En &lt;- (!judge_PbE) * (E - P) # S1 Es &lt;- S * (2 - S / X1) * tanh(En / X1) / (1 + (1 - S / X1) * tanh(En / X1)) # S1 return(list(Evatrans = list(AET = Es), Prec = list(Precipitation = Pn))) # S2-2 2.3.4 Name and Data_ The name of a MODULE should base on the PROCESS name and add the mark of this method. In the example the PROCESS is “ActualET”, and the method can mark as “Gr4j”, so get the MODLUE name “ActualET.Gr4j” ActualET.Gr4j &lt;- function(InData, Param, ...){ # S3 X1 &lt;- Param$Gr4j_X1 # S2-1 E &lt;- InData$Evatrans$RET # S2-1 S &lt;- InData$Ground$MoistureVolume # S2-1 P &lt;- InData$Prec$Precipitation # S2-1 judge_PbE &lt;- P &gt; E # S1 Pn &lt;- judge_PbE * (P - E) # S1 En &lt;- (!judge_PbE) * (E - P) # S1 Es &lt;- S * (2 - S / X1) * tanh(En / X1) / (1 + (1 - S / X1) * tanh(En / X1)) # S1 return(list(Evatrans = list(AET = Es), Prec = list(Precipitation = Pn))) # S2-2 } The Data_ActualET.Gr4j can be write as: Data_ActualET.Gr4j &lt;- list(ref_title = &#39;Improvement of a parsimonious model for streamflow simulation&#39;, ref_bib = &#39;Perrin.2003&#39;, InData = left_merge(t_vari.hm.list(), list(Evatrans = list(RET = t_vari.array(0, c(3))), Ground = list(MoistureVolume = t_vari.array(0, c(3))), Prec = list(Precipitation = t_vari.array(0, c(3))))), Param = list(Gr4j_X1 = c(0.1, 9.99, &#39;mm&#39;)), OutData = left_merge(t_vari.hm.list(), list(Evatrans = list(AET = t_vari.array(0, c(3))), Prec = list(Precipitation = t_vari.array(0, c(3)))))) References "],["module.html", "Chapter 3 Basic Information of MODULEs 3.1 ReferenceET 3.2 ActualET 3.3 SNOW 3.4 BASEFLOW 3.5 INTERCEPTION 3.6 InfiltratRat 3.7 Infiltration 3.8 RUNOFF 3.9 GROUNDWATER 3.10 ROUTE", " Chapter 3 Basic Information of MODULEs Overview of MODULEs PROCESS MODULE ReferenceET ReferenceET.Hargreaves | ReferenceET.Linacre | ReferenceET.PenMon ActualET ActualET.Gr4j | ActualET.Vic SNOW SNOW.17 | SNOW.Ddf BASEFLOW BASEFLOW.ARNO INTERCEPTION INTERCEPTION.Gash InfiltratRat InfiltratRat.GreenAmpt Infiltration Infiltration.OIER | Infiltration.SER RUNOFF RUNOFF.Gr4j | RUNOFF.OIER | RUNOFF.SER | RUNOFF.Vic | RUNOFF.VM GROUNDWATER GROUNDWATER.Vic ROUTE ROUTE.G2RES | ROUTE.Gr4j 3.1 ReferenceET 3.1.1 ReferenceET.Hargreaves This MODULE reference to the Literature: Reference Crop Evapotranspiration from Temperature (George H. Hargreaves and Zohrab A. Samani 1985). InData Group Variable Unit Description MetData TAir Cel Average Air temperature in Timestep TMax Cel Maximal Air temperature in one day TMin Cel Minimul Air temperature in one day GeoData Latitude deg Latitude TimeData NDay – Day nummer in one year Param Paramter Min Max Unit Description PeriodN 1 9999 – The number of Step GridN 1 9999 – The nummber of effektive Grids OutData Group Variable Unit Description Evatrans RET mm Reference evapotranspiration Return to the Overview of MODULEs. 3.1.2 ReferenceET.Linacre This MODULE reference to the Literature: A simple formula for estimating evaporation rates in various climates, using temperature data alone (Linacre 1977). InData Group Variable Unit Description MetData TAir Cel Average Air temperature in Timestep Actual_vapor_press mPa Actual vapor press GeoData Latitude deg Latitude Elevation m Elevation TimeData NDay – Day nummer in one year Param Paramter Min Max Unit Description PeriodN 1 9999 – The number of Step GridN 1 9999 – The nummber of effektive Grids OutData Group Variable Unit Description Evatrans RET mm Reference evapotranspiration Return to the Overview of MODULEs. 3.1.3 ReferenceET.PenMon This MODULE reference to the Literature: Step by Step Calculation of the Penman-Monteith Evapotranspiration (FAO-56) (Lincoln Zotarelli 2014). InData Group Variable Unit Description MetData TAir Cel Average Air temperature in Timestep TMax Cel Maximal Air temperature in one day TMin Cel Minimul Air temperature in one day RelativeHumidity % Relative Humidity, not greater than 100 WindSpeed m/s Average Wind Speed WindH m The hight to mess the WindSpeed SunHour h Sunshine duration in one day GeoData Latitude deg Latitude Elevation m Elevation TimeData NDay – Day nummer in one year Param Paramter Min Max Unit Description PeriodN 1 9999 – The number of Step GridN 1 9999 – The nummber of effektive Grids OutData Group Variable Unit Description Evatrans RET mm Reference evapotranspiration Return to the Overview of MODULEs. 3.2 ActualET 3.2.1 ActualET.Gr4j This MODULE reference to the Literature: Improvement of a parsimonious model for streamflow simulation (Perrin, Michel, and Andréassian 2003). InData Group Variable Unit Description Evatrans RET mm Reference evapotranspiration Ground MoistureVolume mm Moisture volume Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description Gr4j_X1 0.1 9.99 mm NA OutData Group Variable Unit Description Evatrans AET mm Actual evapotranspiration Prec Precipitation mm Precipitation, summe of rain and snow Return to the Overview of MODULEs. 3.2.2 ActualET.Vic This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Aerodyna AerodynaResist s/m Aerodyna Resist ArchitecturalResist s/m Architectural Resist StomatalResist s/m Stomatal Resist Canopy StorageCapacity mm Canopy Storage Capacity for Intercept and Evaporation from Canopy Evatrans RET mm Reference evapotranspiration Ground MoistureVolume mm Moisture volume MoistureCapacityMax mm Maximal Moisture Capacity Intercept Interception mm Interception in Canopy Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description SoilMoistureCapacityB 0 0 – – OutData Group Variable Unit Description Evatrans EvaporationCanopy mm Evaporation from Canopy Transpiration mm Transpiration (water from Root layer of vegetation) EvaporationLand mm Evaporation from Landsurface (sometimes cotain the Evaporation from Watersurface like Lake) Return to the Overview of MODULEs. 3.3 SNOW 3.3.1 SNOW.17 This MODULE reference to the Literature: National Weather Service river forecast system: snow accumulation and ablation model (Anderson 1973). InData Group Variable Unit Description MetData TAir Cel Average Air temperature in Timestep Snow Ice_Volume mm Soild Ice Volume, not depth Liquid_Volume mm Liquid Volume SN17_ATI – – SN17_HD mm – Prec SnowFall mm Snow RainFall mm Rain GeoData Elevation m Elevation TimeData NDay – Day nummer in one year Param Paramter Min Max Unit Description SN17_SCF 0.70 1.40 – Snowfall correction factor SN17_MFMAX 0.50 2.00 mm/6hCel Maximum melt factor considered to occur on June 21 SN17_MFMIN 0.05 0.49 mm/6hCel Minimum melt factor considered to occur on December 21 SN17_UADJ 0.03 0.19 mm/6hCel The average wind function during rain-on-snow periods SN17_NMF 0.05 0.50 mm/6hCel Maximum negative melt factor SN17_TIPM 0.10 1.00 – Antecedent snow temperature index SN17_PXTEMP -2.00 2.00 Cel Temperature that separates rain from snow SN17_MBASE 0.00 1.00 Cel Base temperature for non-rain melt factor SN17_PLWHC 0.02 0.30 – Percent of liquid–water capacity SN17_DAYGM 0.00 0.30 mm/d Daily melt at snow–soil interface TimeStepSec 1.00 9999.00 s Second pro Step OutData Group Variable Unit Description Snow Ice_Volume mm Soild Ice Volume, not depth Liquid_Volume mm Liquid Volume SN17_ATI – – SN17_HD mm – Prec Precipitation mm Precipitation, summe of rain and snow Return to the Overview of MODULEs. 3.3.2 SNOW.Ddf This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Ground MoistureVolume mm Moisture volume Snow Volume mm Summe Volume of Ice and liquid water, not depth Prec SnowFall mm Snow RainFall mm Rain Param Paramter Min Max Unit Description Factor_Day_degree 0 0 – – OutData Group Variable Unit Description Snow Volume mm Summe Volume of Ice and liquid water, not depth Prec Precipitation mm Precipitation, summe of rain and snow Return to the Overview of MODULEs. 3.4 BASEFLOW 3.4.1 BASEFLOW.ARNO This MODULE reference to the Literature: LARGE AREA HYDROLOGIC MODELING AND ASSESSMENT PART I: MODEL DEVELOPMENT (Arnold et al. 1998). InData Group Variable Unit Description Ground MoistureVolume mm Moisture volume MoistureCapacityMax mm Maximal Moisture Capacity Param Paramter Min Max Unit Description ExponentARNOBase 0 0 – – ARNOBaseThresholdRadio 0 0 – – DrainageLossMax 0 0 – – DrainageLossMin 0 0 – – OutData Group Variable Unit Description Ground BaseFlow mm Base Flow Return to the Overview of MODULEs. 3.5 INTERCEPTION 3.5.1 INTERCEPTION.Gash This MODULE reference to the Literature: An analytical model of rainfall interception by forests (Gash 1979). InData Group Variable Unit Description Canopy StorageCapacity mm Canopy Storage Capacity for Intercept and Evaporation from Canopy Evatrans EvaporationCanopy mm Evaporation from Canopy Intercept Interception mm Interception in Canopy Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description CoefficientFreeThroughfall 0 0 – – OutData Group Variable Unit Description Intercept Interception mm Interception in Canopy Prec Precipitation mm Precipitation, summe of rain and snow Return to the Overview of MODULEs. 3.6 InfiltratRat 3.6.1 InfiltratRat.GreenAmpt This MODULE reference to the Literature: Drainage to a water table analysed by the Green-Ampt approach (Youngs and Aggelides 1976). InData Group Variable Unit Description Ground MoistureVolume mm Moisture volume Depth mm Ground Depth SoilData Conductivity m/s Soil actual Conductivity WettingFrontSuction m/s Wetting Front Suction Porosity 100% Soil Porosity, not greater than 1 Param Paramter Min Max Unit Description GridN 1 9999 – NA OutData Group Variable Unit Description Infilt InfiltrationRat mm Infiltration Rate (for some INFITRATION Module) Return to the Overview of MODULEs. 3.7 Infiltration 3.7.1 Infiltration.OIER This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Infilt InfiltrationRat mm Infiltration Rate (for some INFITRATION Module) Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description InfiltrationRateB 0 0 – – OutData Group Variable Unit Description Infilt Infiltration mm Infiltration Return to the Overview of MODULEs. 3.7.2 Infiltration.SER This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Ground MoistureCapacityMax mm Maximal Moisture Capacity MoistureCapacity mm Moisture Capacity Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description SoilMoistureCapacityB 0 0 – – OutData Group Variable Unit Description Infilt Infiltration mm Infiltration Return to the Overview of MODULEs. 3.8 RUNOFF 3.8.1 RUNOFF.Gr4j This MODULE reference to the Literature: Improvement of a parsimonious model for streamflow simulation (Perrin, Michel, and Andréassian 2003). InData Group Variable Unit Description Ground MoistureVolume mm Moisture volume Evatrans AET mm Actual evapotranspiration Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description Gr4j_X1 0.1 9.99 mm NA OutData Group Variable Unit Description Ground Runoff mm Runoff, it will be more wert, when the Runoff is in different form divided MoistureVolume mm Moisture volume Return to the Overview of MODULEs. 3.8.2 RUNOFF.OIER This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Infilt InfiltrationRateMax mm Maximal Infiltration Rate (for some INFITRATION Module) Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description InfiltrationRateB 0 0 – – OutData Group Variable Unit Description Ground Runoff mm Runoff, it will be more wert, when the Runoff is in different form divided Infilt Infiltration mm Infiltration Return to the Overview of MODULEs. 3.8.3 RUNOFF.SER This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Ground MoistureCapacityMax mm Maximal Moisture Capacity MoistureVolume mm Moisture volume Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description SoilMoistureCapacityB 0 0 – – OutData Group Variable Unit Description Ground Runoff mm Runoff, it will be more wert, when the Runoff is in different form divided Infilt Infiltration mm Infiltration Return to the Overview of MODULEs. 3.8.4 RUNOFF.Vic This MODULE reference to the Literature: A new surface runoff parameterization with subgrid-scale soil heterogeneity for land surface models (Liang and Xie 2001). InData Group Variable Unit Description Ground MoistureCapacityMax mm Maximal Moisture Capacity MoistureVolume mm Moisture volume Infilt InfiltrationRat mm Infiltration Rate (for some INFITRATION Module) Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description SoilMoistureCapacityB 0 0 – – InfiltrationRateB 0 0 – – OutData Group Variable Unit Description Ground Runoff mm Runoff, it will be more wert, when the Runoff is in different form divided Infilt Infiltration mm Infiltration Return to the Overview of MODULEs. 3.8.5 RUNOFF.VM This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Ground MoistureCapacity mm Moisture Capacity MoistureCapacityMax mm Maximal Moisture Capacity Infilt InfiltrationRateMax mm Maximal Infiltration Rate (for some INFITRATION Module) Prec Precipitation mm Precipitation, summe of rain and snow Param Paramter Min Max Unit Description SoilMoistureCapacityB 0 0 – – InfiltrationRateB 0 0 – – OutData Group Variable Unit Description Ground Runoff mm Runoff, it will be more wert, when the Runoff is in different form divided Infilt Infiltration mm Infiltration Return to the Overview of MODULEs. 3.9 GROUNDWATER 3.9.1 GROUNDWATER.Vic This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Ground ZoneMoistureVolume mm Moisture volume, when the Ground is in more than one Layer divided ZoneDepth mm Ground Depth, , when the Ground is in more than one Layer divided BaseFlow mm Base Flow Infilt Infiltration mm Infiltration Intercept Interception mm Interception in Canopy SoilData Porosity 100% Soil Porosity, not greater than 1 SaturatedConductivity m/s Soil Saturated Conductivity Param Paramter Min Max Unit Description GridN 1 9999 – The nummber of effektive Grids OutData Group Variable Unit Description Ground Overflow mm Overflow, when the caculated water volume greater than Capacity ZoneMoistureVolume mm Moisture volume, when the Ground is in more than one Layer divided Return to the Overview of MODULEs. 3.10 ROUTE 3.10.1 ROUTE.G2RES This MODULE reference to the Literature: none (???). InData Group Variable Unit Description Route WaterSource mm Water Source for Routing, sometimes the same Data with the Runoff UHAll – All the UH data for all of the Grids for Routr with IUH TypeGridID – The grids type for Routr with IUH TransAll – All of the transform Matrix for all of the Grids for Routr with IUH Param Paramter Min Max Unit Description PeriodN 1 9999 – The number of Step GridN 1 9999 – The nummber of effektive Grids OutData Group Variable Unit Description Route StaFlow m3/s Station Flow in the seted grid Return to the Overview of MODULEs. 3.10.2 ROUTE.Gr4j This MODULE reference to the Literature: Improvement of a parsimonious model for streamflow simulation (Perrin, Michel, and Andréassian 2003). InData Group Variable Unit Description Route WaterSource mm Water Source for Routing, sometimes the same Data with the Runoff Store mm Store in the Route (for some Module) Gr4j_UH1 – UH form 1 only for Module ROUTE.Gr4j, made by the function Gr4j_UH2 – UH form 1 only for Module ROUTE.Gr4j Param Paramter Min Max Unit Description Gr4j_X2 0.1 9.99 mm/Step The catchment water exchange coe icient Gr4j_X3 0.1 9.99 mm The one-day maximal capacity of the routing reservoir Gr4j_X4 1.0 9.99 mm/Step The HU1 unit hydrograph time base time_step_i 1.0 9999.00 – The time Step index OutData Group Variable Unit Description Route StaFlow m3/s Station Flow in the seted grid Store mm Store in the Route (for some Module) Return to the Overview of MODULEs. References "],["model.html", "Chapter 4 Model 4.1 Report 16.4 4.2 Classical VIC 4.3 GR4J", " Chapter 4 Model 4.1 Report 16.4 PROCESS MODULE ReferenceET ReferenceET.Hargreaves | ReferenceET.Linacre | ReferenceET.PenMon ActualET ActualET.Gr4j | ActualET.Vic SNOW SNOW.17 | SNOW.Ddf RUNOFF RUNOFF.Gr4j | RUNOFF.OIER | RUNOFF.SER | RUNOFF.Vic | RUNOFF.VM ROUTE ROUTE.G2RES | ROUTE.Gr4j 4.1.1 Snowmelt Type 1 Temperature \\[SM=(T-T_s)\\times c_f\\] where \\(SM\\) is the snowmelt [mm] (of water), \\(cf\\) is the factor of melt [mm/Cel d], T is the mean air temperature [Cel], and \\(T_s\\) is a threshold temperature value [Cel]. Type 2 Energy (radition) \\[SM=\\frac{ISR\\times(1-\\alpha)+C_0+C_1\\times T}{\\rho \\times L_f}\\] where \\(\\alpha\\) is the snow albedo, \\(ISR\\) is the incoming shortwave radiation [W/m2], \\(C_0\\) and \\(C_1\\) are factors accounting for the temperature-dependent energy fluxes ([W/m2] and [W/m2Cel], respectively), \\(\\rho\\) is the density of snow [kg/m3], and \\(L_f\\) is the fusion latent heat [J/kg]. More information see the literarure (Troin et al. 2018) 4.2 Classical VIC Chapter 3.1 Section 4.3 GR4J References "],["final-words.html", "Chapter 5 Final Words", " Chapter 5 Final Words We have finished a book. "],["references.html", "References", " References "]]
